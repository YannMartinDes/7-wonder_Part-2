version: '3'

services:
  game:
    image: 7wonders:gameserver
    build: ./gameserver
    environment:
      - STATS_IP=172.28.0.253
      - STATS_PORT=1335
      - DO_STATE=true
      - NB_STATE_GAME=100
    depends_on:
      - stats
    networks:
      testing_net:
        ipv4_address: 172.28.0.254

  stats:
    image: 7wonders:statsserver
    build: ./statsserver
    networks:
      testing_net:
        ipv4_address: 172.28.0.253

  client:
    image: 7wonders:client
    build: ./client
    environment:
      - GAME_IP=172.28.0.254
      - GAME_PORT=1336
    depends_on:
      - game
    networks:
      - testing_net

networks:
  testing_net:
    ipam:
      driver: default
      config:
        - subnet: 172.28.0.0/16